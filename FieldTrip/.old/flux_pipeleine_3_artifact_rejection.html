<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2020b"><title>Artifact rejection</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin-bottom: 20px; padding-bottom: 4px;  }
.S2 { margin: 0px; padding: 10px 0px 10px 5px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 700; text-align: start;  }
.S3 { margin: -1px 0px 0px; padding: 10px 0px 10px 7px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: start;  }
.S4 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S5 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S6 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S7 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S8 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S10 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S13 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S14 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S15 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
.diagnosticMessage-wrapper {font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement,.rtcDataTipElement .textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {min-height: 16px;}
.rightPaneElement .textElement {padding-top: 2px; padding-left: 9px;}
.S16 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'H_38EB7A37' ><span>Artifact rejection</span></h1><div  class = 'S1'><div  class = 'S2'><span style=' font-weight: bold;'>Table of Contents</span></div><div  class = 'S3'><a href = "#H_58C20F6F"><span>Background
</span></a><a href = "#H_46F56E20"><span>Requirements
</span></a><a href = "#H_20C958E3"><span>Reading the data and filtering in planar gradiometers
</span></a><a href = "#H_61902F3E"><span>Artefact rejections in planar gradiometers
</span></a><span>    </span><a href = "#H_B28E2FC8"><span>Question 1
</span></a><span>    </span><a href = "#H_CF3AC5B3"><span>Question 2
</span></a><span>    </span><a href = "#H_D9ABFA85"><span>Question 3
</span></a><a href = "#H_3926104C"><span>Preregistration and publications</span></a></div></div><h2  class = 'S4' id = 'H_58C20F6F' ><span style=' font-weight: bold;'>Background</span></h2><div  class = 'S5'><span>The aim of MEG research is to characterise the brain activity  associated with a given task. However, MEG is also sensitive to magnetic fields from the environment as well as various non-brain related  artefacts created by the subject.  </span></div><div  class = 'S5'><span>That major environmental artefacts include </span></div><ul  class = 'S6'><li  class = 'S7'><span> 50 Hz line noise (60 Hz in the US and parts of Japan)</span></li><li  class = 'S7'><span> Mechanical vibrations resulting in the MEG system moving within the always exciting DC field. This produces a measurable signal</span></li><li  class = 'S7'><span> Stimulus equipment. For instance the electrical pulse resulting from electrical nerve stimulation at the median nerve produces a  sizeable signal</span></li><li  class = 'S7'><span> Moving objects such as nearby cars </span></li><li  class = 'S7'><span> Malfunctioning MEG sensors. For instance 'SQUID jumps'. </span></li></ul><div  class = 'S5'><span>The body related artefacts are primarily  </span></div><ul  class = 'S6'><li  class = 'S7'><span> Head movements</span></li><li  class = 'S7'><span> Eye blinks</span></li><li  class = 'S7'><span> Saccades</span></li><li  class = 'S7'><span> Cardiac artefacts; i.e. electrical field generated by the heart </span></li><li  class = 'S7'><span> Belt or bras with metal resulting in breathing artefacts</span></li><li  class = 'S7'><span> Piercings and make-up with metal (some mascara)</span></li><li  class = 'S7'><span> Dental work involving metal e.g. tooth fillings or braces </span></li><li  class = 'S7'><span> Muscle contractions resulting in broadband activity</span></li></ul><div  class = 'S5'><span>It is not possible to completely remove these artefacts but a lot can be done to reduce their impact. The main strategies are 1) remove  trials with artefacts and 2) using temporal (e.g. notch filters) or spatial filters (e.g. ICA). </span></div><div  class = 'S5'><span>As part of the preprocessing the data will be corrected for mean amplitude differences across trial and then trials/sensors with large artefacts will be removed. These steps to remove large artefacts are important to perform prior applying ICA for further artefact attenuation (see next section). </span></div><div  class = 'S5'><span></span></div><h2  class = 'S4' id = 'H_46F56E20' ><span style=' font-weight: bold;'>Requirements</span></h2><div  class = 'S5'><span>The FIFF-file with the raw data: </span></div><div  class = 'S5'><span style=' font-style: italic;'>training_raw-1.fif</span><span>  </span><span style=' font-style: italic;'>training_raw-2.fif</span><span>  </span></div><div  class = 'S5'><span>Navigate to the data directory where these two FIFF files are.</span></div><div  class = 'S5'><span>Also make sure that the path to FieldTrip is set and then run the function ft_defaults.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre;"><span>ft_defaults</span></span></div></div></div><h2  class = 'S9' id = 'H_20C958E3' ><span style=' font-weight: bold;'>Reading the data and filtering in planar gradiometers</span></h2><div  class = 'S5'><span>We will first read in the trials using the tools from the previous  section. Remember however that the recording is in two different  datafiles, because the size of the recorded data is over 3.7GB. So first specify the datafiles: </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>dataset{1,1}=</span><span style="color: rgb(170, 4, 249);">'training_raw-1.fif'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>dataset{1,2}=</span><span style="color: rgb(170, 4, 249);">'training_raw-2.fif'</span><span>;</span></span></div></div></div><div  class = 'S12'><span>We will call ft_preprocessing.m but now with each datafile and correcting for mean amplitude difference across trials. In addition we  will focus on the planar gradiometers only so we will restrict the  channels to the gradiometers ('MEGGRAD').   </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">for </span><span>i=1:2</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg  = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.dataset = char(dataset{1,i});  </span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.trialfun = </span><span style="color: rgb(170, 4, 249);">'ft_trialfun_general'</span><span>;  </span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.trialdef.eventtype  = </span><span style="color: rgb(170, 4, 249);">'STI101'</span><span>;  </span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.trialdef.eventvalue = [21 22];  </span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.trialdef.prestim = 2.5;  </span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.trialdef.poststim = 2;  </span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg  = ft_definetrial(cfg);   </span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.channel = {</span><span style="color: rgb(170, 4, 249);">'MEGGRAD'</span><span>};  </span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.demean = </span><span style="color: rgb(170, 4, 249);">'yes'</span><span>;    </span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span class="warning_squiggle_rte217184993">data</span><span>(i,1)  = ft_preprocessing(cfg); </span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="DEB72F16" data-scroll-top="null" data-scroll-left="null" data-testid="output_0" data-width="722" data-height="492" data-hashorizontaloverflow="false" style="width: 752px; max-height: 503px;"><div class="textElement">evaluating trialfunction 'ft_trialfun_general'
reading the header from 'training_raw-1.fif'
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	306 MEG channel locations transformed
Reading training_raw-1.fif ...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
Opening raw data file training_raw-1.fif...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	Range : 208000 ... 1664999  =    208.000 ...  1664.999 secs
Ready.</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsWarningElement" uid="CA01A075" data-testid="output_1" data-width="722" data-height="18" data-hashorizontaloverflow="false" style="width: 752px; max-height: 261px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType"><div class="diagnosticMessage-messagePart">Warning: assuming that the default scaling should be amplitude/distance rather than amplitude</div><div class="diagnosticMessage-stackPart"></div></div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="916C8504" data-scroll-top="null" data-scroll-left="null" data-testid="output_2" data-width="722" data-height="579" data-hashorizontaloverflow="false" style="width: 752px; max-height: 261px;"><div class="textElement">reading the events from 'training_raw-1.fif'
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	306 MEG channel locations transformed
Reading training_raw-1.fif ...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
Opening raw data file training_raw-1.fif...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	Range : 208000 ... 1664999  =    208.000 ...  1664.999 secs
Ready.
Reading 208000 ... 1664999  =    208.000 ...  1664.999 secs... [done]
Reading 208000 ... 1664999  =    208.000 ...  1664.999 secs... [done]
Fixing trigger at sample 331854
Fixing trigger at sample 838423
found 3359 events
created 139 trials
the call to "ft_definetrial" took 18 seconds</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="52059107" data-scroll-top="null" data-scroll-left="null" data-testid="output_3" data-width="722" data-height="2537" data-hashorizontaloverflow="true" style="width: 752px; max-height: 261px;"><div class="textElement">	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	306 MEG channel locations transformed
Reading training_raw-1.fif ...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
Opening raw data file training_raw-1.fif...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	Range : 208000 ... 1664999  =    208.000 ...  1664.999 secs
Ready.
processing channel { 'MEG0112' 'MEG0113' 'MEG0122' 'MEG0123' 'MEG0132' 'MEG0133' 'MEG0142' 'MEG0143' 'MEG0212' 'MEG0213' 'MEG0222' 'MEG0223' 'MEG0232' 'MEG0233' 'MEG0242' 'MEG0243' 'MEG0312' 'MEG0313' 'MEG0322' 'MEG0323' 'MEG0332' 'MEG0333' 'MEG0342' 'MEG0343' 'MEG0412' 'MEG0413' 'MEG0422' 'MEG0423' 'MEG0432' 'MEG0433' 'MEG0442' 'MEG0443' 'MEG0512' 'MEG0513' 'MEG0522' 'MEG0523' 'MEG0532' 'MEG0533' 'MEG0542' 'MEG0543' 'MEG0612' 'MEG0613' 'MEG0622' 'MEG0623' 'MEG0632' 'MEG0633' 'MEG0642' 'MEG0643' 'MEG0712' 'MEG0713' 'MEG0722' 'MEG0723' 'MEG0732' 'MEG0733' 'MEG0742' 'MEG0743' 'MEG0812' 'MEG0813' 'MEG0822' 'MEG0823' 'MEG0912' 'MEG0913' 'MEG0922' 'MEG0923' 'MEG0932' 'MEG0933' 'MEG0942' 'MEG0943' 'MEG1012' 'MEG1013' 'MEG1022' 'MEG1023' 'MEG1032' 'MEG1033' 'MEG1042' 'MEG1043' 'MEG1112' 'MEG1113' 'MEG1122' 'MEG1123' 'MEG1132' 'MEG1133' 'MEG1142' 'MEG1143' 'MEG1212' 'MEG1213' 'MEG1222' 'MEG1223' 'MEG1232' 'MEG1233' 'MEG1242' 'MEG1243' 'MEG1312' 'MEG1313' 'MEG1322' 'MEG1323' 'MEG1332' 'MEG1333' 'MEG1342' 'MEG1343' 'MEG1412' 'MEG1413' 'MEG1422' 'MEG1423' 'MEG1432' 'MEG1433' 'MEG1442' 'MEG1443' 'MEG1512' 'MEG1513' 'MEG1522' 'MEG1523' 'MEG1532' 'MEG1533' 'MEG1542' 'MEG1543' 'MEG1612' 'MEG1613' 'MEG1622' 'MEG1623' 'MEG1632' 'MEG1633' 'MEG1642' 'MEG1643' 'MEG1712' 'MEG1713' 'MEG1722' 'MEG1723' 'MEG1732' 'MEG1733' 'MEG1742' 'MEG1743' 'MEG1812' 'MEG1813' 'MEG1822' 'MEG1823' 'MEG1832' 'MEG1833' 'MEG1842' 'MEG1843' 'MEG1912' 'MEG1913' 'MEG1922' 'MEG1923' 'MEG1932' 'MEG1933' 'MEG1942' 'MEG1943' 'MEG2012' 'MEG2013' 'MEG2022' 'MEG2023' 'MEG2032' 'MEG2033' 'MEG2042' 'MEG2043' 'MEG2112' 'MEG2113' 'MEG2122' 'MEG2123' 'MEG2132' 'MEG2133' 'MEG2142' 'MEG2143' 'MEG2212' 'MEG2213' 'MEG2222' 'MEG2223' 'MEG2232' 'MEG2233' 'MEG2242' 'MEG2243' 'MEG2312' 'MEG2313' 'MEG2322' 'MEG2323' 'MEG2332' 'MEG2333' 'MEG2342' 'MEG2343' 'MEG2412' 'MEG2413' 'MEG2422' 'MEG2423' 'MEG2432' 'MEG2433' 'MEG2442' 'MEG2443' 'MEG2512' 'MEG2513' 'MEG2522' 'MEG2523' 'MEG2532' 'MEG2533' 'MEG2542' 'MEG2543' 'MEG2612' 'MEG2613' 'MEG2622' 'MEG2623' 'MEG2632' 'MEG2633' 'MEG2642' 'MEG2643' }
reading and preprocessing
Reading 232279 ... 236778  =    232.279 ...   236.778 secs... [done]
reading and preprocessing trial 2 from 139
Reading 239077 ... 243576 reading and preprocessing trial 3 from 139
Reading 246925 ... 251424 reading and preprocessing trial 4 from 139
Reading 254139 ... 258638  =    254.139 ...   258.638 secs... [done]
Reading 262922 ... 267421 reading and preprocessing trial 6 from 139
Reading 270953 ... 275452  =    270.953 ...   275.452 secs... [done]
Reading 279052 ... 283551 reading and preprocessing trial 8 from 139
Reading 288151 ... 292650  =    288.151 ...   292.650 secs... [done]
Reading 297250 ... 301749 reading and preprocessing trial 10 from 139
Reading 304073 ... 308572reading and preprocessing trial 11 from 139
Reading 310987 ... 315486reading and preprocessing trial 12 from 139
Reading 318952 ... 323451reading and preprocessing trial 13 from 139
Reading 327685 ... 332184reading and preprocessing trial 14 from 139
Reading 336942 ... 341441reading and preprocessing trial 15 from 139
Reading 344966 ... 349465reading and preprocessing trial 16 from 139
Reading 353873 ... 358372reading and preprocessing trial 17 from 139
Reading 362839 ... 367338  =    362.839 ...   367.338 secs... [done]
Reading 369803 ... 374302reading and preprocessing trial 19 from 139
Reading 377435 ... 381934reading and preprocessing trial 20 from 139
Reading 386368 ... 390867reading and preprocessing trial 21 from 139
Reading 394191 ... 398690  =    394.191 ...   398.690 secs... [done]
Reading 402289 ... 406788reading and preprocessing trial 23 from 139
Reading 411547 ... 416046  =    411.547 ...   416.046 secs... [done]
Reading 419604 ... 424103reading and preprocessing trial 25 from 139
Reading 426835 ... 431334reading and preprocessing trial 26 from 139
Reading 434416 ... 438915  =    434.416 ...   438.915 secs... [done]
Reading 453674 ... 458173reading and preprocessing trial 28 from 139
Reading 462565 ... 467064reading and preprocessing trial 29 from 139
Reading 471823 ... 476322reading and preprocessing trial 30 from 139
Reading 481081 ... 485580reading and preprocessing trial 31 from 139
Reading 490047 ... 494546reading and preprocessing trial 32 from 139
Reading 498771 ... 503270reading and preprocessing trial 33 from 139
Reading 505835 ... 510334reading and preprocessing trial 34 from 139
Reading 514784 ... 519283reading and preprocessing trial 35 from 139
Reading 523667 ... 528166reading and preprocessing trial 36 from 139
Reading 530839 ... 535338reading and preprocessing trial 37 from 139
Reading 538571 ... 543070reading and preprocessing trial 38 from 139
Reading 546761 ... 551260reading and preprocessing trial 39 from 139
Reading 554668 ... 559167reading and preprocessing trial 40 from 139
Reading 562858 ... 567357reading and preprocessing trial 41 from 139
Reading 570473 ... 574972reading and preprocessing trial 42 from 139
Reading 577787 ... 582286reading and preprocessing trial 43 from 139
Reading 585752 ... 590251reading and preprocessing trial 44 from 139
Reading 593059 ... 597558  =    593.059 ...   597.558 secs... [done]
Reading 600073 ... 604572reading and preprocessing trial 46 from 139
Reading 608980 ... 613479reading and preprocessing trial 47 from 139
Reading 617863 ... 622362reading and preprocessing trial 48 from 139
Reading 626562 ... 631061reading and preprocessing trial 49 from 139
Reading 634293 ... 638792  =    634.293 ...   638.792 secs... [done]
Reading 643159 ... 647658reading and preprocessing trial 51 from 139
Reading 650891 ... 655390reading and preprocessing trial 52 from 139
Reading 658005 ... 662504reading and preprocessing trial 53 from 139
Reading 695220 ... 699719  =    695.220 ...   699.719 secs... [done]
Reading 704211 ... 708710reading and preprocessing trial 55 from 139
Reading 713135 ... 717634  =    713.135 ...   717.634 secs... [done]
Reading 721434 ... 725933reading and preprocessing trial 57 from 139
Reading 730358 ... 734857reading and preprocessing trial 58 from 139
Reading 737389 ... 741888  =    737.389 ...   741.888 secs... [done]
Reading 744920 ... 749419reading and preprocessing trial 60 from 139
Reading 751809 ... 756308reading and preprocessing trial 61 from 139
Reading 760558 ... 765057reading and preprocessing trial 62 from 139
Reading 768965 ... 773464reading and preprocessing trial 63 from 139
Reading 777898 ... 782397  =    777.898 ...   782.397 secs... [done]
Reading 786922 ... 791421reading and preprocessing trial 65 from 139
Reading 795229 ... 799728reading and preprocessing trial 66 from 139
Reading 803203 ... 807702reading and preprocessing trial 67 from 139
Reading 811952 ... 816451reading and preprocessing trial 68 from 139
Reading 820718 ... 825217reading and preprocessing trial 69 from 139
Reading 829442 ... 833941  =    829.442 ...   833.941 secs... [done]
Reading 838699 ... 843198reading and preprocessing trial 71 from 139
Reading 847690 ... 852189  =    847.690 ...   852.189 secs... [done]
Reading 855605 ... 860104reading and preprocessing trial 73 from 139
Reading 864354 ... 868853  =    864.354 ...   868.853 secs... [done]
Reading 873045 ... 877544reading and preprocessing trial 75 from 139
Reading 881402 ... 885901reading and preprocessing trial 76 from 139
Reading 888900 ... 893399reading and preprocessing trial 77 from 139
Reading 898158 ... 902657  =    898.158 ...   902.657 secs... [done]
Reading 906506 ... 911005reading and preprocessing trial 79 from 139
Reading 963354 ... 967853  =    963.354 ...   967.853 secs... [done]
Reading 972437 ... 976936reading and preprocessing trial 81 from 139
Reading 980444 ... 984943reading and preprocessing trial 82 from 139
Reading 989702 ... 994201reading and preprocessing trial 83 from 139
Reading 998042 ... 1002541reading and preprocessing trial 84 from 139
Reading 1005115 ... 1009614reading and preprocessing trial 85 from 139
Reading 1013555 ... 1018054reading and preprocessing trial 86 from 139
Reading 1020878 ... 1025377reading and preprocessing trial 87 from 139
Reading 1028968 ... 1033467reading and preprocessing trial 88 from 139
Reading 1036558 ... 1041057reading and preprocessing trial 89 from 139
Reading 1043923 ... 1048422  =   1043.923 ...  1048.422 secs... [done]
Reading 1052355 ... 1056854reading and preprocessing trial 91 from 139
Reading 1060620 ... 1065119reading and preprocessing trial 92 from 139
Reading 1069878 ... 1074377reading and preprocessing trial 93 from 139
Reading 1078393 ... 1082892reading and preprocessing trial 94 from 139
Reading 1087126 ... 1091625reading and preprocessing trial 95 from 139
Reading 1094574 ... 1099073reading and preprocessing trial 96 from 139
Reading 1102756 ... 1107255reading and preprocessing trial 97 from 139
Reading 1110662 ... 1115161reading and preprocessing trial 98 from 139
Reading 1118561 ... 1123060reading and preprocessing trial 99 from 139
Reading 1125942 ... 1130441reading and preprocessing trial 100 from 139
Reading 1134883 ... 113938reading and preprocessing trial 101 from 139
Reading 1143632 ... 114813reading and preprocessing trial 102 from 139
Reading 1150938 ... 115543reading and preprocessing trial 103 from 139
Reading 1159804 ... 116430reading and preprocessing trial 104 from 139
Reading 1168895 ... 117339reading and preprocessing trial 105 from 139
Reading 1380215 ... 138471reading and preprocessing trial 106 from 139
Reading 1388363 ... 139286reading and preprocessing trial 107 from 139
Reading 1396562 ... 140106reading and preprocessing trial 108 from 139
Reading 1405820 ... 141031reading and preprocessing trial 109 from 139
Reading 1414736 ... 141923reading and preprocessing trial 110 from 139
Reading 1423993 ... 142849reading and preprocessing trial 111 from 139
Reading 1432217 ... 143671reading and preprocessing trial 112 from 139
Reading 1439290 ... 144378reading and preprocessing trial 113 from 139
Reading 1446220 ... 145071reading and preprocessing trial 114 from 139
Reading 1453068 ... 1457567  =   1453.068 ...  1457.567 secs... [done]
Reading 1461500 ... 146599reading and preprocessing trial 116 from 139
Reading 1468356 ... 1472855  =   1468.356 ...  1472.855 secs... [done]
Reading 1475996 ... 148049reading and preprocessing trial 118 from 139
Reading 1484444 ... 1488943  =   1484.444 ...  1488.943 secs... [done]
Reading 1491083 ... 149558reading and preprocessing trial 120 from 139
Reading 1498198 ... 1502697  =   1498.198 ...  1502.697 secs... [done]
Reading 1505229 ... 150972reading and preprocessing trial 122 from 139
Reading 1512360 ... 151685reading and preprocessing trial 123 from 139
Reading 1520792 ... 152529reading and preprocessing trial 124 from 139
Reading 1527581 ... 153208reading and preprocessing trial 125 from 139
Reading 1534328 ... 153882reading and preprocessing trial 126 from 139
Reading 1541509 ... 154600reading and preprocessing trial 127 from 139
Reading 1549141 ... 155364reading and preprocessing trial 128 from 139
Reading 1557439 ... 1561938  =   1557.439 ...  1561.938 secs... [done]
Reading 1565888 ... 157038reading and preprocessing trial 130 from 139
Reading 1574863 ... 157936reading and preprocessing trial 131 from 139
Reading 1590926 ... 159542reading and preprocessing trial 132 from 139
Reading 1597815 ... 160231reading and preprocessing trial 133 from 139
Reading 1605964 ... 161046reading and preprocessing trial 134 from 139
Reading 1612853 ... 161735reading and preprocessing trial 135 from 139
Reading 1620993 ... 162549reading and preprocessing trial 136 from 139
Reading 1629525 ... 163402reading and preprocessing trial 137 from 139
Reading 1636606 ... 164110reading and preprocessing trial 138 from 139
Reading 1643737 ... 164823reading and preprocessing trial 139 from 139
Reading 1652995 ... 1657494  =   1652.995 ...  1657.494 secs... [done]

the call to "ft_preprocessing" took 16 seconds</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="7C0BB93D" data-scroll-top="null" data-scroll-left="null" data-testid="output_4" data-width="722" data-height="1040" data-hashorizontaloverflow="false" style="width: 752px; max-height: 261px;"><div class="textElement">evaluating trialfunction 'ft_trialfun_general'
reading the header from 'training_raw-2.fif'
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	306 MEG channel locations transformed
Reading training_raw-2.fif ...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
Opening raw data file training_raw-2.fif...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	Range : 1665000 ... 3098999  =   1665.000 ...  3098.999 secs
Ready.
reading the events from 'training_raw-2.fif'
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	306 MEG channel locations transformed
Reading training_raw-2.fif ...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
Opening raw data file training_raw-2.fif...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	Range : 1665000 ... 3098999  =   1665.000 ...  3098.999 secs
Ready.
Reading 1665000 ... 3098999  =   1665.000 ...  3098.999 secs... [done]
Reading 1665000 ... 3098999  =   1665.000 ...  3098.999 secs... [done]
found 4129 events
created 172 trials
the call to "ft_definetrial" took 17 seconds</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="E0CB7246" data-scroll-top="null" data-scroll-left="null" data-testid="output_5" data-width="722" data-height="3013" data-hashorizontaloverflow="true" style="width: 752px; max-height: 261px;"><div class="textElement">	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	306 MEG channel locations transformed
Reading training_raw-2.fif ...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
Opening raw data file training_raw-2.fif...
	Read a total of 8 projection items:
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
		generated with autossp-1.2.0 (1 x 306) idle
	Range : 1665000 ... 3098999  =   1665.000 ...  3098.999 secs
Ready.
processing channel { 'MEG0112' 'MEG0113' 'MEG0122' 'MEG0123' 'MEG0132' 'MEG0133' 'MEG0142' 'MEG0143' 'MEG0212' 'MEG0213' 'MEG0222' 'MEG0223' 'MEG0232' 'MEG0233' 'MEG0242' 'MEG0243' 'MEG0312' 'MEG0313' 'MEG0322' 'MEG0323' 'MEG0332' 'MEG0333' 'MEG0342' 'MEG0343' 'MEG0412' 'MEG0413' 'MEG0422' 'MEG0423' 'MEG0432' 'MEG0433' 'MEG0442' 'MEG0443' 'MEG0512' 'MEG0513' 'MEG0522' 'MEG0523' 'MEG0532' 'MEG0533' 'MEG0542' 'MEG0543' 'MEG0612' 'MEG0613' 'MEG0622' 'MEG0623' 'MEG0632' 'MEG0633' 'MEG0642' 'MEG0643' 'MEG0712' 'MEG0713' 'MEG0722' 'MEG0723' 'MEG0732' 'MEG0733' 'MEG0742' 'MEG0743' 'MEG0812' 'MEG0813' 'MEG0822' 'MEG0823' 'MEG0912' 'MEG0913' 'MEG0922' 'MEG0923' 'MEG0932' 'MEG0933' 'MEG0942' 'MEG0943' 'MEG1012' 'MEG1013' 'MEG1022' 'MEG1023' 'MEG1032' 'MEG1033' 'MEG1042' 'MEG1043' 'MEG1112' 'MEG1113' 'MEG1122' 'MEG1123' 'MEG1132' 'MEG1133' 'MEG1142' 'MEG1143' 'MEG1212' 'MEG1213' 'MEG1222' 'MEG1223' 'MEG1232' 'MEG1233' 'MEG1242' 'MEG1243' 'MEG1312' 'MEG1313' 'MEG1322' 'MEG1323' 'MEG1332' 'MEG1333' 'MEG1342' 'MEG1343' 'MEG1412' 'MEG1413' 'MEG1422' 'MEG1423' 'MEG1432' 'MEG1433' 'MEG1442' 'MEG1443' 'MEG1512' 'MEG1513' 'MEG1522' 'MEG1523' 'MEG1532' 'MEG1533' 'MEG1542' 'MEG1543' 'MEG1612' 'MEG1613' 'MEG1622' 'MEG1623' 'MEG1632' 'MEG1633' 'MEG1642' 'MEG1643' 'MEG1712' 'MEG1713' 'MEG1722' 'MEG1723' 'MEG1732' 'MEG1733' 'MEG1742' 'MEG1743' 'MEG1812' 'MEG1813' 'MEG1822' 'MEG1823' 'MEG1832' 'MEG1833' 'MEG1842' 'MEG1843' 'MEG1912' 'MEG1913' 'MEG1922' 'MEG1923' 'MEG1932' 'MEG1933' 'MEG1942' 'MEG1943' 'MEG2012' 'MEG2013' 'MEG2022' 'MEG2023' 'MEG2032' 'MEG2033' 'MEG2042' 'MEG2043' 'MEG2112' 'MEG2113' 'MEG2122' 'MEG2123' 'MEG2132' 'MEG2133' 'MEG2142' 'MEG2143' 'MEG2212' 'MEG2213' 'MEG2222' 'MEG2223' 'MEG2232' 'MEG2233' 'MEG2242' 'MEG2243' 'MEG2312' 'MEG2313' 'MEG2322' 'MEG2323' 'MEG2332' 'MEG2333' 'MEG2342' 'MEG2343' 'MEG2412' 'MEG2413' 'MEG2422' 'MEG2423' 'MEG2432' 'MEG2433' 'MEG2442' 'MEG2443' 'MEG2512' 'MEG2513' 'MEG2522' 'MEG2523' 'MEG2532' 'MEG2533' 'MEG2542' 'MEG2543' 'MEG2612' 'MEG2613' 'MEG2622' 'MEG2623' 'MEG2632' 'MEG2633' 'MEG2642' 'MEG2643' }
reading and preprocessing
Reading 1668483 ... 1672982  =   1668.483 ...  1672.982 secs... [done]
reading and preprocessing trial 2 from 172
Reading 1675214 ... 1679713  =   1675.214 ...  1679.713 secs... [done]
Reading 1681978 ... 1686477 reading and preprocessing trial 4 from 172
Reading 1689142 ... 1693641  =   1689.142 ...  1693.641 secs... [done]
Reading 1696390 ... 1700889 reading and preprocessing trial 6 from 172
Reading 1703221 ... 1707720  =   1703.221 ...  1707.720 secs... [done]
Reading 1710310 ... 1714809 reading and preprocessing trial 8 from 172
Reading 1719293 ... 1723792 reading and preprocessing trial 9 from 172
Reading 1726349 ... 1730848 reading and preprocessing trial 10 from 172
Reading 1733697 ... 1738196reading and preprocessing trial 11 from 172
Reading 1742637 ... 1747136reading and preprocessing trial 12 from 172
Reading 1751895 ... 1756394reading and preprocessing trial 13 from 172
Reading 1758901 ... 1763400reading and preprocessing trial 14 from 172
Reading 1767400 ... 1771899reading and preprocessing trial 15 from 172
Reading 1774381 ... 1778880reading and preprocessing trial 16 from 172
Reading 1781187 ... 1785686reading and preprocessing trial 17 from 172
Reading 1805949 ... 1810448reading and preprocessing trial 18 from 172
Reading 1815049 ... 1819548reading and preprocessing trial 19 from 172
Reading 1822155 ... 1826654reading and preprocessing trial 20 from 172
Reading 1830920 ... 1835419reading and preprocessing trial 21 from 172
Reading 1838068 ... 1842567reading and preprocessing trial 22 from 172
Reading 1845182 ... 1849681  =   1845.182 ...  1849.681 secs... [done]
Reading 1854123 ... 1858622reading and preprocessing trial 24 from 172
Reading 1863064 ... 1867563  =   1863.064 ...  1867.563 secs... [done]
Reading 1870187 ... 1874686reading and preprocessing trial 26 from 172
Reading 1877251 ... 1881750reading and preprocessing trial 27 from 172
Reading 1885083 ... 1889582reading and preprocessing trial 28 from 172
Reading 1894340 ... 1898839reading and preprocessing trial 29 from 172
Reading 1902189 ... 1906688  =   1902.189 ...  1906.688 secs... [done]
Reading 1910963 ... 1915462reading and preprocessing trial 31 from 172
Reading 1918077 ... 1922576reading and preprocessing trial 32 from 172
Reading 1926726 ... 1931225reading and preprocessing trial 33 from 172
Reading 1935742 ... 1940241reading and preprocessing trial 34 from 172
Reading 1943632 ... 1948131reading and preprocessing trial 35 from 172
Reading 1950763 ... 1955262reading and preprocessing trial 36 from 172
Reading 1959446 ... 1963945reading and preprocessing trial 37 from 172
Reading 1966743 ... 1971242reading and preprocessing trial 38 from 172
Reading 1976001 ... 1980500reading and preprocessing trial 39 from 172
Reading 1984967 ... 1989466reading and preprocessing trial 40 from 172
Reading 1992165 ... 1996664reading and preprocessing trial 41 from 172
Reading 1999980 ... 2004479reading and preprocessing trial 42 from 172
Reading 2009054 ... 2013553reading and preprocessing trial 43 from 172
Reading 2023716 ... 2028215reading and preprocessing trial 44 from 172
Reading 2031214 ... 2035713reading and preprocessing trial 45 from 172
Reading 2038162 ... 2042661reading and preprocessing trial 46 from 172
Reading 2045877 ... 2050376reading and preprocessing trial 47 from 172
Reading 2053475 ... 2057974reading and preprocessing trial 48 from 172
Reading 2062207 ... 2066706  =   2062.207 ...  2066.706 secs... [done]
Reading 2070097 ... 2074596reading and preprocessing trial 50 from 172
Reading 2076861 ... 2081360reading and preprocessing trial 51 from 172
Reading 2084493 ... 2088992reading and preprocessing trial 52 from 172
Reading 2091532 ... 2096031reading and preprocessing trial 53 from 172
Reading 2100790 ... 2105289reading and preprocessing trial 54 from 172
Reading 2107504 ... 2112003reading and preprocessing trial 55 from 172
Reading 2115194 ... 2119693reading and preprocessing trial 56 from 172
Reading 2123968 ... 2128467reading and preprocessing trial 57 from 172
Reading 2131724 ... 2136223reading and preprocessing trial 58 from 172
Reading 2140515 ... 2145014reading and preprocessing trial 59 from 172
Reading 2148088 ... 2152587reading and preprocessing trial 60 from 172
Reading 2155870 ... 2160369reading and preprocessing trial 61 from 172
Reading 2163810 ... 2168309reading and preprocessing trial 62 from 172
Reading 2170799 ... 2175298reading and preprocessing trial 63 from 172
Reading 2180057 ... 2184556reading and preprocessing trial 64 from 172
Reading 2187855 ... 2192354reading and preprocessing trial 65 from 172
Reading 2195578 ... 2200077reading and preprocessing trial 66 from 172
Reading 2202776 ... 2207275reading and preprocessing trial 67 from 172
Reading 2210341 ... 2214840reading and preprocessing trial 68 from 172
Reading 2219056 ... 2223555  =   2219.056 ...  2223.555 secs... [done]
Reading 2233744 ... 2238243reading and preprocessing trial 70 from 172
Reading 2241050 ... 2245549reading and preprocessing trial 71 from 172
Reading 2249999 ... 2254498reading and preprocessing trial 72 from 172
Reading 2257489 ... 2261988reading and preprocessing trial 73 from 172
Reading 2265254 ... 2269753reading and preprocessing trial 74 from 172
Reading 2274161 ... 2278660  =   2274.161 ...  2278.660 secs... [done]
Reading 2282927 ... 2287426reading and preprocessing trial 76 from 172
Reading 2291209 ... 2295708reading and preprocessing trial 77 from 172
Reading 2298598 ... 2303097reading and preprocessing trial 78 from 172
Reading 2307414 ... 2311913reading and preprocessing trial 79 from 172
Reading 2315538 ... 2320037reading and preprocessing trial 80 from 172
Reading 2322944 ... 2327443reading and preprocessing trial 81 from 172
Reading 2330892 ... 2335391reading and preprocessing trial 82 from 172
Reading 2338841 ... 2343340reading and preprocessing trial 83 from 172
Reading 2347406 ... 2351905reading and preprocessing trial 84 from 172
Reading 2356664 ... 2361163reading and preprocessing trial 85 from 172
Reading 2365513 ... 2370012reading and preprocessing trial 86 from 172
Reading 2373553 ... 2378052reading and preprocessing trial 87 from 172
Reading 2381835 ... 2386334reading and preprocessing trial 88 from 172
Reading 2389992 ... 2394491reading and preprocessing trial 89 from 172
Reading 2397273 ... 2401772reading and preprocessing trial 90 from 172
Reading 2406531 ... 2411030reading and preprocessing trial 91 from 172
Reading 2415364 ... 2419863reading and preprocessing trial 92 from 172
Reading 2423946 ... 2428445reading and preprocessing trial 93 from 172
Reading 2431461 ... 2435960reading and preprocessing trial 94 from 172
Reading 2439509 ... 2444008reading and preprocessing trial 95 from 172
Reading 2454597 ... 2459096reading and preprocessing trial 96 from 172
Reading 2462370 ... 2466869reading and preprocessing trial 97 from 172
Reading 2470785 ... 2475284reading and preprocessing trial 98 from 172
Reading 2478784 ... 2483283reading and preprocessing trial 99 from 172
Reading 2487274 ... 2491773reading and preprocessing trial 100 from 172
Reading 2495631 ... 250013reading and preprocessing trial 101 from 172
Reading 2504739 ... 250923reading and preprocessing trial 102 from 172
Reading 2511620 ... 251611reading and preprocessing trial 103 from 172
Reading 2520878 ... 252537reading and preprocessing trial 104 from 172
Reading 2528659 ... 253315reading and preprocessing trial 105 from 172
Reading 2537801 ... 254230reading and preprocessing trial 106 from 172
Reading 2546483 ... 255098reading and preprocessing trial 107 from 172
Reading 2554414 ... 2558913  =   2554.414 ...  2558.913 secs... [done]
Reading 2562396 ... 256689reading and preprocessing trial 109 from 172
Reading 2569119 ... 2573618  =   2569.119 ...  2573.618 secs... [done]
Reading 2578251 ... 258275reading and preprocessing trial 111 from 172
Reading 2586717 ... 259121reading and preprocessing trial 112 from 172
Reading 2595791 ... 260029reading and preprocessing trial 113 from 172
Reading 2604282 ... 260878reading and preprocessing trial 114 from 172
Reading 2612230 ... 261672reading and preprocessing trial 115 from 172
Reading 2620720 ... 262521reading and preprocessing trial 116 from 172
Reading 2627626 ... 263212reading and preprocessing trial 117 from 172
Reading 2634399 ... 2638898  =   2634.399 ...  2638.898 secs... [done]
Reading 2642714 ... 264721reading and preprocessing trial 119 from 172
Reading 2651972 ... 265647reading and preprocessing trial 120 from 172
Reading 2660638 ... 266513reading and preprocessing trial 121 from 172
Reading 2675975 ... 268047reading and preprocessing trial 122 from 172
Reading 2684724 ... 268922reading and preprocessing trial 123 from 172
Reading 2692331 ... 269683reading and preprocessing trial 124 from 172
Reading 2700504 ... 270500reading and preprocessing trial 125 from 172
Reading 2708653 ... 271315reading and preprocessing trial 126 from 172
Reading 2716968 ... 272146reading and preprocessing trial 127 from 172
Reading 2724958 ... 272945reading and preprocessing trial 128 from 172
Reading 2731789 ... 273628reading and preprocessing trial 129 from 172
Reading 2740513 ... 274501reading and preprocessing trial 130 from 172
Reading 2748462 ... 275296reading and preprocessing trial 131 from 172
Reading 2756485 ... 276098reading and preprocessing trial 132 from 172
Reading 2764133 ... 276863reading and preprocessing trial 133 from 172
Reading 2771681 ... 277618reading and preprocessing trial 134 from 172
Reading 2778512 ... 278301reading and preprocessing trial 135 from 172
Reading 2786235 ... 279073reading and preprocessing trial 136 from 172
Reading 2794584 ... 279908reading and preprocessing trial 137 from 172
Reading 2803842 ... 280834reading and preprocessing trial 138 from 172
Reading 2812024 ... 281652reading and preprocessing trial 139 from 172
Reading 2819738 ... 282423reading and preprocessing trial 140 from 172
Reading 2828487 ... 283298reading and preprocessing trial 141 from 172
Reading 2836803 ... 284130reading and preprocessing trial 142 from 172
Reading 2844534 ... 284903reading and preprocessing trial 143 from 172
Reading 2853792 ... 285829reading and preprocessing trial 144 from 172
Reading 2861857 ... 286635reading and preprocessing trial 145 from 172
Reading 2870656 ... 287515reading and preprocessing trial 146 from 172
Reading 2879380 ... 288387reading and preprocessing trial 147 from 172
Reading 2893667 ... 289816reading and preprocessing trial 148 from 172
Reading 2901090 ... 290558reading and preprocessing trial 149 from 172
Reading 2909706 ... 291420reading and preprocessing trial 150 from 172
Reading 2916645 ... 292114reading and preprocessing trial 151 from 172
Reading 2923634 ... 292813reading and preprocessing trial 152 from 172
Reading 2930382 ... 293488reading and preprocessing trial 153 from 172
Reading 2937246 ... 294174reading and preprocessing trial 154 from 172
Reading 2945828 ... 295032reading and preprocessing trial 155 from 172
Reading 2952534 ... 295703reading and preprocessing trial 156 from 172
Reading 2959440 ... 296393reading and preprocessing trial 157 from 172
Reading 2968456 ... 297295reading and preprocessing trial 158 from 172
Reading 2977497 ... 298199reading and preprocessing trial 159 from 172
Reading 2984511 ... 298901reading and preprocessing trial 160 from 172
Reading 2991617 ... 299611reading and preprocessing trial 161 from 172
Reading 3000875 ... 300537reading and preprocessing trial 162 from 172
Reading 3008122 ... 301262reading and preprocessing trial 163 from 172
Reading 3017380 ... 302187reading and preprocessing trial 164 from 172
Reading 3024294 ... 302879reading and preprocessing trial 165 from 172
Reading 3031200 ... 303569reading and preprocessing trial 166 from 172
Reading 3039791 ... 304429reading and preprocessing trial 167 from 172
Reading 3048440 ... 305293reading and preprocessing trial 168 from 172
Reading 3055888 ... 306038reading and preprocessing trial 169 from 172
Reading 3064653 ... 306915reading and preprocessing trial 170 from 172
Reading 3071785 ... 307628reading and preprocessing trial 171 from 172
Reading 3078957 ... 308345reading and preprocessing trial 172 from 172
Reading 3087731 ... 3092230  =   3087.731 ...  3092.230 secs... [done]

the call to "ft_preprocessing" took 21 seconds</div></div></div></div></div><div  class = 'S5'><span>Next will merge the datafiles into one single dataset as they represent  the first and the second part of the recording. In addition, we will  remove the 'sampleinfo' field of the newly created datafile, because it  would otherwise cause some confusion later due to the merging of two  datafiles. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>cfg = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.keepsampleinfo = </span><span style="color: rgb(170, 4, 249);">'no'</span><span>;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span>data_planar = ft_appenddata(cfg,data(1,1),data(2,1));</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="193F9008" data-scroll-top="null" data-scroll-left="null" data-testid="output_6" data-width="722" data-height="46" data-hashorizontaloverflow="false" style="width: 752px; max-height: 261px;"><div class="textElement">concatenating over the "rpt" dimension
the call to "ft_selectdata" took 0 seconds
the call to "ft_appenddata" took 0 seconds</div></div></div></div></div><h2  class = 'S9' id = 'H_61902F3E' ><span>Artefact rejections in planar gradiometers</span></h2><div  class = 'S5'><span></span></div><div  class = 'S5'><span>Having preprocessed the data, the next step is to detect trials and sensors with large artefacts and remove those prior to running ICA. For this purpose we will use Fieldtrip's ft_rejectvisual function and will rely on summary statistics of the data to detect artifacts (http://www.fieldtriptoolbox.org/tutorial/visual_artifact_rejection). The aim of this step is to reject trials with excessive noise i.e. by assessing if they are outliers.</span></div><div  class = 'S5'><span>It is worth having ft_databrowser running whilst deciding about what trials/sensors should be removed with ft_rejectvisual. So call in ft_databrowser and choose the cfg.viewmode ='vertical' option.</span></div><div  class = 'S5'><span>To show a set of representative sensors front and in the rim write: </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>cfg = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.viewmode=</span><span style="color: rgb(170, 4, 249);">'vertical'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.continuous=</span><span style="color: rgb(170, 4, 249);">'no'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.ylim=[ -1e-11  1e-11 ];</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.channel = {</span><span style="color: rgb(170, 4, 249);">'MEG01*'</span><span>,</span><span style="color: rgb(170, 4, 249);">'MEG05*'</span><span>};  </span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>ft_databrowser(cfg, data_planar);</span></span></div></div></div><div  class = 'S5'><span>Plotting all of the sensors </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>cfg = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.viewmode=</span><span style="color: rgb(170, 4, 249);">'vertical'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.continuous=</span><span style="color: rgb(170, 4, 249);">'no'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>ft_databrowser(cfg, data_planar);</span></span></div></div></div><div  class = 'S12'><span>This will produce an interactive figure with all the planar gradiometer data. Keep the figure on when running ft_rejectvisual. </span></div><h3  class = 'S16' id = 'H_B28E2FC8' ><span style=' font-weight: bold;'>Question 1</span></h3><div  class = 'S5'><span>Browse through the trials. Identify an eyeblink, a muscle artifact  and the cardiac heart artifacts (hint;look between trial 50-70). Return  plots showing the respective artifacts and briefly explain what  characterized them. </span></div><div  class = 'S5'><span></span></div><div  class = 'S5'><span>Before doing the visual artifact rejection run the below line. This will be useful for later bookeeping as to which trials and channels we keep  after this first round of artifact rejection. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre;"><span>data_planar.trialinfo(1:end,2)=1:length(data_planar.trialinfo);  </span></span></div></div></div><div  class = 'S12'><span>To remove particularly noisy trials and/or sensors one can use  statistical properties of the trials and sensors, such as the variance  of the data. To do so use ft_rejectivual with the cfg.method set as  'summary'. There are a number of statistical properties to be  considered. In addition at this step you should also identify flat or  bad sensors  for later channelrepair. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>cfg=[];</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.method  = </span><span style="color: rgb(170, 4, 249);">'summary'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>cfg.layout  = </span><span style="color: rgb(170, 4, 249);">'neuromag306planar.lay'</span><span>;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S14'><span style="white-space: pre;"><span>planar_rjv1  = ft_rejectvisual(cfg, data_planar);</span></span></div><div  class = 'S15'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="E5C380A2" data-scroll-top="null" data-scroll-left="null" data-testid="output_7" data-width="722" data-height="18" data-hashorizontaloverflow="false" style="width: 752px; max-height: 261px;"><div class="textElement">the input is raw data with 204 channels and 311 trials</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsWarningElement" uid="2E692DD9" data-testid="output_8" data-width="722" data-height="18" data-hashorizontaloverflow="false" style="width: 752px; max-height: 261px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType"><div class="diagnosticMessage-messagePart">Warning: sampleinfo in the configuration is inconsistent with the actual data</div><div class="diagnosticMessage-stackPart"></div></div></div><div class="inlineElement eoOutputWrapper embeddedOutputsWarningElement" uid="294F822E" data-testid="output_9" data-width="722" data-height="18" data-hashorizontaloverflow="false" style="width: 752px; max-height: 261px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType"><div class="diagnosticMessage-messagePart">Warning: reconstructing sampleinfo by assuming that the trials are consecutive segments of a continuous recording</div><div class="diagnosticMessage-stackPart"></div></div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="99319D3A" data-scroll-top="null" data-scroll-left="null" data-testid="output_10" data-width="722" data-height="46" data-hashorizontaloverflow="false" style="width: 752px; max-height: 261px;"><div class="textElement">before GUI interaction: 311 trials marked to INCLUDE, 0 trials marked to EXCLUDE
before GUI interaction: 204 channels marked to INCLUDE, 0 channels marked to EXCLUDE
showing a summary of the data for all channels and trials</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="AC9F5BC6" data-scroll-top="null" data-scroll-left="null" data-testid="output_11" data-width="722" data-height="18" data-hashorizontaloverflow="true" style="width: 752px; max-height: 261px;"><div class="textElement">computing metric [--|                                                      ]computing metric [----/                                                    ]computing metric [-------                                                  ]computing metric [--------\                                                ]computing metric [----------|                                              ]computing metric [------------/                                            ]computing metric [---------------                                          ]computing metric [----------------\                                        ]computing metric [------------------|                                      ]computing metric [---------------------/                                   ]computing metric [------------------------                                 ]computing metric [-------------------------\                               ]computing metric [---------------------------|                             ]computing metric [-----------------------------/                           ]computing metric [---------------------------------                        ]computing metric [----------------------------------\                      ]computing metric [------------------------------------|                    ]computing metric [--------------------------------------/                  ]computing metric [-----------------------------------------                ]computing metric [------------------------------------------\              ]computing metric [---------------------------------------------|           ]computing metric [-----------------------------------------------/         ]computing metric [--------------------------------------------------       ]computing metric [---------------------------------------------------\     ]computing metric [------------------------------------------------------|  ]computing metric [--------------------------------------------------------/]</div></div><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="E0E3D8E7" data-scroll-top="null" data-scroll-left="null" data-testid="output_12" data-width="722" data-height="90" data-hashorizontaloverflow="true" style="width: 752px; max-height: 261px;"><div class="textElement">after GUI interaction: 287 trials marked to INCLUDE, 24 trials marked to EXCLUDE
after GUI interaction: 203 channels marked to INCLUDE, 1 channels marked to EXCLUDE
the following channels were removed: MEG0923
the following trials were removed: 68, 83, 99, 105, 110, 112, 118, 123, 124, 130, 131, 133, 136, 137, 141, 154, 183, 187, 192, 233, 249, 288, 290, 294
the call to "ft_selectdata" took 1 seconds
the call to "ft_rejectvisual" took 130 seconds</div></div></div></div></div><div  class = 'S12'><span>With the variance option ticked the figure shows that a couple of  trials (bottom left sub-figure)have cosiderably larger variance than the rest and the same is true for a few sensors (top right plot).  </span></div><div  class = 'S5'><span>The noisiest trial is Nr 105. Entering 105 in the 'Plot trial' box  (bottom right)  makes a topographically arranged sensor plot of trial  105 (bottom left). This allows to select a particular sensor (or more  than one) and inspect  the data more closely. Select the sensor over  (MEG0923) with the largest deflection  of the trial to observe the data  of one channel for one trial (bottom right).   </span></div><div  class = 'S5'><span>Inspect the data with ft_databrowser also shows that there is a large amplitude deflection in the signal on a few channels.  </span></div><div  class = 'S5'><span>Remove trial 105 from the dataset by going back to the original  summary statistics figure and dragging the mouse over the particular  trial datapoint in the bottom left plot. By doing so the name of the  trial number ('105') will appear under the 'Rejected Trials'.  </span></div><div  class = 'S5'><span>Removing the trial also changes the sub-plot and it turns out  there is another trial (136) in close proximity with similarly large  noise. In addition to removing trials with large variance the sensor  MEG0923 seems to have considerably larger variance than the rest. This  is the sensor which was mentioned above standing out because of it being rather noisy. </span></div><div  class = 'S5'><span>Here we removed a total of 24 trials and 1 channel with a relatively large amount of variance indicated by the variance plot.    </span></div><div  class = 'S5'><span>After removing this channel we can move on to the next step.  However before doing so we need to complete the bookeeping of the trials and channels we kept. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>trl_keep=planar_rjv1.trialinfo(1:end,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>planar_rjv1.trialinfo(:,2)=[];</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>chan_rej=setdiff(data_planar.label,planar_rjv1.label);</span></span></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre;"><span>chan_keep=data_planar.label;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>chan_keep(</span><span class="warning_squiggle_rte217184993 warningHighlight217184993">find</span><span>(ismember(data_planar.label(:,1), chan_rej(:,1))))= [];</span></span></div></div></div><div  class = 'S12'><span>NOTE: in order for Fieldtrip to perform the rejection of the sensors  and create the new structure 'planar_rjv1' press the button 'Quit'.  Furthermore,note that the list of artifactual trials and sensors can be  augmented manually. This can for instance be done after browsing through the trials in ft_databrowser.m or another data browser. </span></div><div  class = 'S5'><span>As a final step it is a good idea to save the variables which contain the channel list and the trial list we want to keep.  </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre;"><span>save(</span><span style="color: rgb(170, 4, 249);">'chan_keep.mat'</span><span>, </span><span style="color: rgb(170, 4, 249);">'chan_keep'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre;"><span>save(</span><span style="color: rgb(170, 4, 249);">'trl_keep.mat'</span><span>, </span><span style="color: rgb(170, 4, 249);">'trl_keep'</span><span>)</span></span></div></div></div><h3  class = 'S16' id = 'H_CF3AC5B3' ><span style=' font-weight: bold;'>Question 2</span></h3><div  class = 'S5'><span>Use some of the other options e.g. maxabs or maxzvalue. What is the effect on the outliers?  </span></div><h3  class = 'S16' id = 'H_D9ABFA85' ><span style=' font-weight: bold;'>Question 3</span></h3><div  class = 'S5'><span>What is better to remove bad sensors before bad trials or other way round? </span></div><h2  class = 'S4' id = 'H_3926104C' ><span style=' font-weight: bold;'>Preregistration and publications</span></h2><div  class = 'S5'><span>Describe the filter type, and settings (filter order, cutoff  frequencies) and the padding applied. Also specify if detrending was  performed.  </span></div><div  class = 'S5'><span style=' font-weight: bold;'>Preregistration:</span><span> report how rejection of trials and  sensors will be done. For instance by visual inspection and summary  statistics to remove outliers. Make explicit if this will be done  separately for gradiometers and the magnetometers. Define how trials  with ocular artefacts will be handled. Importantly define the criteria  for rejecting the dataset for a specific subject. For instance this  might be when more than 25% of the trials has to be rejected or if there were serious data quality problems for instance due to dental work,  environmental problems or  excessive movements.  </span></div><div  class = 'S5'><span style=' font-weight: bold;'>Publications:</span><span> report the artefact rejection strategy from  above. Report the average number and standard deviation of numbers of  sensors and trials excluded. If bad channels were interpolated, describe how it was done.  </span></div><div  class = 'S5'><span>EXAMPLE:</span></div><div  class = 'S5'><span>"The mean of each trials was removed. After  preprocessing the planar gradiometers inspected visually for artifacts  and outlier trials and sensors with excessive variance were removed. In  average XX(+/-YY) trials were per subject and ZZ(+/-WW) sensors.  </span></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Artifact rejection
%% *Background*
% The aim of MEG research is to characterise the brain activity  associated 
% with a given task. However, MEG is also sensitive to magnetic fields from the 
% environment as well as various non-brain related  artefacts created by the subject.  
% 
% That major environmental artefacts include 
%% 
% * 50 Hz line noise (60 Hz in the US and parts of Japan)
% * Mechanical vibrations resulting in the MEG system moving within the always 
% exciting DC field. This produces a measurable signal
% * Stimulus equipment. For instance the electrical pulse resulting from electrical 
% nerve stimulation at the median nerve produces a  sizeable signal
% * Moving objects such as nearby cars 
% * Malfunctioning MEG sensors. For instance 'SQUID jumps'. 
%% 
% The body related artefacts are primarily  
%% 
% * Head movements
% * Eye blinks
% * Saccades
% * Cardiac artefacts; i.e. electrical field generated by the heart 
% * Belt or bras with metal resulting in breathing artefacts
% * Piercings and make-up with metal (some mascara)
% * Dental work involving metal e.g. tooth fillings or braces 
% * Muscle contractions resulting in broadband activity
%% 
% It is not possible to completely remove these artefacts but a lot can be done 
% to reduce their impact. The main strategies are 1) remove  trials with artefacts 
% and 2) using temporal (e.g. notch filters) or spatial filters (e.g. ICA). 
% 
% As part of the preprocessing the data will be corrected for mean amplitude 
% differences across trial and then trials/sensors with large artefacts will be 
% removed. These steps to remove large artefacts are important to perform prior 
% applying ICA for further artefact attenuation (see next section). 
% 
% 
%% *Requirements*
% The FIFF-file with the raw data: 
% 
% _training_raw-1.fif_  _training_raw-2.fif_  
% 
% Navigate to the data directory where these two FIFF files are.
% 
% Also make sure that the path to FieldTrip is set and then run the function 
% ft_defaults.

ft_defaults
%% *Reading the data and filtering in planar gradiometers*
% We will first read in the trials using the tools from the previous  section. 
% Remember however that the recording is in two different  datafiles, because 
% the size of the recorded data is over 3.7GB. So first specify the datafiles: 

dataset{1,1}='training_raw-1.fif';
dataset{1,2}='training_raw-2.fif';
%% 
% We will call ft_preprocessing.m but now with each datafile and correcting 
% for mean amplitude difference across trials. In addition we  will focus on the 
% planar gradiometers only so we will restrict the  channels to the gradiometers 
% ('MEGGRAD').   


for i=1:2

cfg  = [];
cfg.dataset = char(dataset{1,i});  
cfg.trialfun = 'ft_trialfun_general';  
cfg.trialdef.eventtype  = 'STI101';  
cfg.trialdef.eventvalue = [21 22];  
cfg.trialdef.prestim = 2.5;  
cfg.trialdef.poststim = 2;  
cfg  = ft_definetrial(cfg);   
cfg.channel = {'MEGGRAD'};  
cfg.demean = 'yes';    
data(i,1)  = ft_preprocessing(cfg); 
end
%% 
% Next will merge the datafiles into one single dataset as they represent  the 
% first and the second part of the recording. In addition, we will  remove the 
% 'sampleinfo' field of the newly created datafile, because it  would otherwise 
% cause some confusion later due to the merging of two  datafiles. 

cfg = [];
cfg.keepsampleinfo = 'no';
data_planar = ft_appenddata(cfg,data(1,1),data(2,1));
%% Artefact rejections in planar gradiometers
% 
% 
% Having preprocessed the data, the next step is to detect trials and sensors 
% with large artefacts and remove those prior to running ICA. For this purpose 
% we will use Fieldtrip's ft_rejectvisual function and will rely on summary statistics 
% of the data to detect artifacts (http://www.fieldtriptoolbox.org/tutorial/visual_artifact_rejection). 
% The aim of this step is to reject trials with excessive noise i.e. by assessing 
% if they are outliers.
% 
% It is worth having ft_databrowser running whilst deciding about what trials/sensors 
% should be removed with ft_rejectvisual. So call in ft_databrowser and choose 
% the cfg.viewmode ='vertical' option.
% 
% To show a set of representative sensors front and in the rim write: 

cfg = [];
cfg.viewmode='vertical';
cfg.continuous='no';
cfg.ylim=[ -1e-11  1e-11 ];
cfg.channel = {'MEG01*','MEG05*'};  
ft_databrowser(cfg, data_planar);
%% 
% Plotting all of the sensors 

cfg = [];
cfg.viewmode='vertical';
cfg.continuous='no';
ft_databrowser(cfg, data_planar);
%% 
% This will produce an interactive figure with all the planar gradiometer data. 
% Keep the figure on when running ft_rejectvisual. 
% *Question 1*
% Browse through the trials. Identify an eyeblink, a muscle artifact  and the 
% cardiac heart artifacts (hint;look between trial 50-70). Return  plots showing 
% the respective artifacts and briefly explain what  characterized them. 
% 
% 
%% 
% Before doing the visual artifact rejection run the below line. This will be 
% useful for later bookeeping as to which trials and channels we keep  after this 
% first round of artifact rejection. 

data_planar.trialinfo(1:end,2)=1:length(data_planar.trialinfo);  
%% 
% To remove particularly noisy trials and/or sensors one can use  statistical 
% properties of the trials and sensors, such as the variance  of the data. To 
% do so use ft_rejectivual with the cfg.method set as  'summary'. There are a 
% number of statistical properties to be  considered. In addition at this step 
% you should also identify flat or  bad sensors  for later channelrepair. 

cfg=[];
cfg.method  = 'summary';
cfg.layout  = 'neuromag306planar.lay';
planar_rjv1  = ft_rejectvisual(cfg, data_planar);
%% 
% With the variance option ticked the figure shows that a couple of  trials 
% (bottom left sub-figure)have cosiderably larger variance than the rest and the 
% same is true for a few sensors (top right plot).  
% 
% The noisiest trial is Nr 105. Entering 105 in the 'Plot trial' box  (bottom 
% right)  makes a topographically arranged sensor plot of trial  105 (bottom left). 
% This allows to select a particular sensor (or more  than one) and inspect  the 
% data more closely. Select the sensor over  (MEG0923) with the largest deflection  
% of the trial to observe the data  of one channel for one trial (bottom right).   
% 
% Inspect the data with ft_databrowser also shows that there is a large amplitude 
% deflection in the signal on a few channels.  
% 
% Remove trial 105 from the dataset by going back to the original  summary statistics 
% figure and dragging the mouse over the particular  trial datapoint in the bottom 
% left plot. By doing so the name of the  trial number ('105') will appear under 
% the 'Rejected Trials'.  
% 
% Removing the trial also changes the sub-plot and it turns out  there is another 
% trial (136) in close proximity with similarly large  noise. In addition to removing 
% trials with large variance the sensor  MEG0923 seems to have considerably larger 
% variance than the rest. This  is the sensor which was mentioned above standing 
% out because of it being rather noisy. 
% 
% Here we removed a total of 24 trials and 1 channel with a relatively large 
% amount of variance indicated by the variance plot.    
%% 
% After removing this channel we can move on to the next step.  However before 
% doing so we need to complete the bookeeping of the trials and channels we kept. 

trl_keep=planar_rjv1.trialinfo(1:end,2);
planar_rjv1.trialinfo(:,2)=[];
chan_rej=setdiff(data_planar.label,planar_rjv1.label);
chan_keep=data_planar.label;
chan_keep(find(ismember(data_planar.label(:,1), chan_rej(:,1))))= [];
%% 
% NOTE: in order for Fieldtrip to perform the rejection of the sensors  and 
% create the new structure 'planar_rjv1' press the button 'Quit'.  Furthermore,note 
% that the list of artifactual trials and sensors can be  augmented manually. 
% This can for instance be done after browsing through the trials in ft_databrowser.m 
% or another data browser. 
% 
% As a final step it is a good idea to save the variables which contain the 
% channel list and the trial list we want to keep.  

save('chan_keep.mat', 'chan_keep')
save('trl_keep.mat', 'trl_keep')
% *Question 2*
% Use some of the other options e.g. maxabs or maxzvalue. What is the effect 
% on the outliers?  
% *Question 3*
% What is better to remove bad sensors before bad trials or other way round? 
%% *Preregistration and publications*
% Describe the filter type, and settings (filter order, cutoff  frequencies) 
% and the padding applied. Also specify if detrending was  performed.  
% 
% *Preregistration:* report how rejection of trials and  sensors will be done. 
% For instance by visual inspection and summary  statistics to remove outliers. 
% Make explicit if this will be done  separately for gradiometers and the magnetometers. 
% Define how trials  with ocular artefacts will be handled. Importantly define 
% the criteria  for rejecting the dataset for a specific subject. For instance 
% this  might be when more than 25% of the trials has to be rejected or if there 
% were serious data quality problems for instance due to dental work,  environmental 
% problems or  excessive movements.  
% 
% *Publications:* report the artefact rejection strategy from  above. Report 
% the average number and standard deviation of numbers of  sensors and trials 
% excluded. If bad channels were interpolated, describe how it was done.  
% 
% EXAMPLE:
% 
% "The mean of each trials was removed. After  preprocessing the planar gradiometers 
% inspected visually for artifacts  and outlier trials and sensors with excessive 
% variance were removed. In  average XX(+/-YY) trials were per subject and ZZ(+/-WW) 
% sensors.
##### SOURCE END #####
--></body></html>